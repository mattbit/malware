""""""
import pandas as pd
import numpy as np

HEADERS = ("time", "src", "dst", "protocol",
           "http_host", "dns_host", "sni_host")

df = pd.read_csv("../data/all.csv", header=None, names=HEADERS)


def domain_name(record):
    for field in ["http_host", "sni_host", "dns_host"]:
        if not pd.isnull(record[field]):
            return record[field]


df["domain"] = df.apply(domain_name, axis=1)
df = df.drop(columns=["http_host", "sni_host", "dns_host"])

dx = df[~df.domain.str.endswith(".local").fillna(True)]

# Write a csv with the preprocessed data.
dx.to_csv("preprocessed.csv", index=False)

df = pd.read_csv("preprocessed.csv")
df.time
# Letâ€™s build a graph linking
